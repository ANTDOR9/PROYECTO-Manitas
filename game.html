<!DOCTYPE html>
<html lang="es">
<head>
<<<<<<< HEAD
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MANITAS - Juego en Curso</title>
  
  <!-- Precarga de recursos crÃ­ticos -->
  <link rel="preload" href="css/base.css" as="style">
  <link rel="preload" href="css/variables.css" as="style">
  <link rel="preload" href="css/animations.css" as="style">
  <link rel="preload" href="css/game.css" as="style">
  <link rel="preload" href="js/main.js" as="script">
  <link rel="preload" href="assets/videos/2.mp4" as="video" type="video/mp4">
  
  <!-- Fuentes -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  
  <!-- CSS modular -->
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/animations.css">
  <link rel="stylesheet" href="css/game.css">
  
  <!-- Confetti library -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js" defer></script>
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="assets/images/favicon.ico">
  
  <!-- Meta tags -->
  <meta name="description" content="Juego educativo sobre higiene y seguridad de manos - Â¡Pon a prueba tus conocimientos!">
</head>
<body class="game-container" aria-label="Juego de higiene de manos en curso">
  <!-- Video de fondo del juego -->
  <video 
    class="game-video-bg" 
    id="bgVideo"
    autoplay 
    loop 
    muted 
    playsinline
    preload="auto"
    aria-hidden="true"
  >
    <source src="assets/videos/2.mp4" type="video/mp4">
    <source src="assets/videos/2.webm" type="video/webm">
  </video>
  
  <!-- Overlay para contraste -->
  <div class="game-video-overlay" aria-hidden="true"></div>
  
  <!-- Contadores de puntuaciÃ³n y racha -->
  <div class="game-counter game-score-counter" aria-label="Puntaje actual">
    <img src="assets/images/23.png" alt="Icono de puntaje" class="game-counter-icon">
    <span id="totalCorrectDisplay" class="game-counter-value">0</span>
  </div>
  
  <div class="game-counter game-streak-counter" aria-label="Racha actual">
    <span id="streakDisplay" class="game-counter-value">0</span>
    <img src="assets/images/3.png" alt="Icono de racha" class="game-counter-icon">
  </div>
  
  <!-- Contador de vidas (se crearÃ¡ dinÃ¡micamente) -->
  <div id="livesDisplay" class="game-lives-display" aria-label="Vidas restantes" hidden></div>
  
  <!-- Contador de preguntas (se crearÃ¡ dinÃ¡micamente) -->
  <div id="questionCounter" class="game-question-counter" aria-label="Progreso de preguntas" hidden></div>
  
  <!-- Contenedor principal del juego -->
  <div class="container" role="main">
    <!-- Barra de progreso del tiempo -->
    <div class="game-progress-container" aria-label="Tiempo restante">
      <div class="game-progress-bar">
        <div class="game-progress-fill" id="progress" role="progressbar" 
             aria-valuemin="0" aria-valuemax="100" aria-valuenow="100">
        </div>
      </div>
    </div>
    
    <!-- Temporizador -->
    <div class="game-timer" id="timerDisplay" aria-live="polite">
      Tiempo: 20s
    </div>
    
    <!-- Pregunta actual -->
    <h1 class="game-question" id="question" aria-live="polite">
      Cargando pregunta...
    </h1>
    
    <!-- Opciones de respuesta -->
    <div class="game-options-container" role="group" aria-label="Opciones de respuesta">
      <div class="game-options-grid" id="options">
        <!-- Las opciones se cargarÃ¡n dinÃ¡micamente -->
      </div>
    </div>
    
    <!-- Mensajes de feedback -->
    <div class="game-message-container" aria-live="assertive">
      <div class="game-message" id="message"></div>
    </div>
    
    <!-- BotÃ³n de enviar -->
    <div class="game-send-btn-container">
      <button 
        class="game-send-btn" 
        id="sendBtn"
        aria-label="Enviar respuesta"
      >
        Enviar Respuesta
      </button>
    </div>
  </div>
  
  <!-- Botones de control (se crearÃ¡n dinÃ¡micamente) -->
  <button id="pauseBtn" class="game-control-btn" aria-label="Pausar juego" hidden></button>
  <button id="soundToggle" class="game-control-btn" aria-label="Alternar sonido" hidden></button>
  
  <!-- Modal de game over/victoria (se crearÃ¡ dinÃ¡micamente) -->
  
  <!-- Scripts modulares -->
  <script type="module" src="js/main.js"></script>
  
  <!-- Script inline para inicializaciÃ³n bÃ¡sica -->
  <script>
    // ConfiguraciÃ³n inicial bÃ¡sica mientras carga el mÃ³dulo principal
    document.addEventListener('DOMContentLoaded', function() {
      // Mostrar elementos ocultos
      const livesDisplay = document.getElementById('livesDisplay');
      const questionCounter = document.getElementById('questionCounter');
      const pauseBtn = document.getElementById('pauseBtn');
      const soundToggle = document.getElementById('soundToggle');
      
      if (livesDisplay) {
        livesDisplay.hidden = false;
        livesDisplay.textContent = 'â¤ï¸â¤ï¸â¤ï¸';
      }
      
      if (questionCounter) {
        questionCounter.hidden = false;
        questionCounter.textContent = '0/15';
      }
      
      if (pauseBtn) {
        pauseBtn.hidden = false;
        pauseBtn.innerHTML = 'â¸ï¸';
        pauseBtn.title = 'Pausar juego';
      }
      
      if (soundToggle) {
        soundToggle.hidden = false;
        soundToggle.innerHTML = 'ðŸ”Š';
        soundToggle.title = 'Alternar sonido';
      }
      
      // Configurar video de fondo
      const bgVideo = document.getElementById('bgVideo');
      if (bgVideo) {
        bgVideo.volume = 0.3;
        
        // Intentar reproducir inmediatamente
        bgVideo.play().catch(function(error) {
          console.log('Autoplay blocked:', error);
          
          // Reproducir en la primera interacciÃ³n del usuario
          const playVideo = function() {
            bgVideo.play().catch(() => {});
            document.removeEventListener('click', playVideo);
            document.removeEventListener('keydown', playVideo);
          };
          
          document.addEventListener('click', playVideo);
          document.addEventListener('keydown', playVideo);
        });
        
        // Repetir video automÃ¡ticamente
        bgVideo.addEventListener('ended', function() {
          this.currentTime = 0;
          this.play();
        });
      }
      
      // Habilitar sonido en primera interacciÃ³n
      function enableSound() {
        if (bgVideo && bgVideo.muted) {
          bgVideo.muted = false;
          bgVideo.volume = 0.5;
        }
        
        // TambiÃ©n habilitar sonido del juego
        if (window.audioManager) {
          window.audioManager.setEnabled(true);
        }
        
        document.removeEventListener('click', enableSound);
        document.removeEventListener('keydown', enableSound);
      }
      
      document.addEventListener('click', enableSound);
      document.addEventListener('keydown', enableSound);
      
      // Mostrar mensaje de carga
      const messageEl = document.getElementById('message');
      if (messageEl) {
        messageEl.textContent = 'Cargando juego...';
        messageEl.className = 'game-message info';
      }
    });
    
    // FunciÃ³n global para volver al inicio
    window.volverAlInicio = function() {
      window.location.href = 'index.html';
    };
  </script>
=======
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Manitas - Juego</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;}
html,body{height:100%;font-family:'Poppins',sans-serif;overflow:hidden;}
video{position:fixed;top:0;left:0;width:100%;height:100%;object-fit:cover;z-index:-1;}
.overlay{position:fixed;inset:0;background:linear-gradient(135deg, rgba(0,0,0,0.4), rgba(0,0,0,0.2));z-index:0;}
.container{position:relative;z-index:1;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;color:#fff;text-align:center;padding:20px;max-width:800px;margin:0 auto;}
h1{font-size:2rem;margin-bottom:20px;text-shadow:3px 3px 10px rgba(0,0,0,0.8);font-weight:600;letter-spacing:1px;max-height:4rem;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;text-overflow:ellipsis;}
#question{
  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:normal;
  word-break:break-word;
  font-size:clamp(1rem, 2vw, 2.5rem);
  line-height:1.2;
  max-height:6.2em;
  margin-bottom:10px;
  max-width: 95vw;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
}
.timer-display{font-size:1.5rem;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.7);margin-bottom:10px;}
.options{display:flex;flex-direction:column;gap:15px;margin-top:30px;width:100%;max-width:600px;}
button{padding:15px 30px;border:none;border-radius:12px;background:linear-gradient(45deg, #00bfa5, #00e0b5);color:#fff;font-size:1.2rem;font-weight:600;cursor:pointer;transition:0.3s; box-shadow:0 4px 8px rgba(0,0,0,0.3);text-transform:uppercase;letter-spacing:0.5px;}
button:hover{background:linear-gradient(45deg, #00e0b5, #00bfa5);transform:translateY(-2px);box-shadow:0 6px 12px rgba(0,0,0,0.4);}
.option-btn{background:black !important;color:white !important;padding:20px 40px !important;box-shadow:0 8px 16px rgba(0,0,0,0.7) !important;transform: perspective(1000px) rotateX(0deg);border-radius:15px;border:2px solid #fff;}
.option-btn:hover{transform: perspective(1000px) rotateX(-10deg) translateY(-5px);box-shadow:0 12px 24px rgba(0,0,0,0.8) !important;}
.message{font-size:2rem;font-weight:700;text-shadow:2px 2px 6px rgba(0,0,0,0.7);min-height:40px;flex:1;text-align:left;}
.progress-bar{width:90%;height:25px;background:#333;border-radius:15px;margin-bottom:30px;overflow:hidden;box-shadow:inset 0 2px 4px rgba(0,0,0,0.5);}
.progress{height:100%;width:100%;background:linear-gradient(90deg, #00ff8c, #00bfa5);transition:width 0.1s;border-radius:15px;}

.bottom-row{display:flex;justify-content:center;align-items:center;width:100%;max-width:600px;margin-top:20px;}

@keyframes floatUp {
  0% { transform: translateY(0) scale(1); opacity: 1; }
  100% { transform: translateY(-50px) scale(1.2); opacity: 0; }
}

@keyframes fadeIn {
  0% { opacity: 0; }
  100% { opacity: 1; }
}

.game-over {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(0, 0, 0, 0.9);
  padding: 40px;
  border-radius: 20px;
  text-align: center;
  z-index: 100;
  border: 3px solid #ff0000;
  box-shadow: 0 0 30px rgba(255, 0, 0, 0.5);
  animation: fadeIn 0.5s ease-in;
}

.game-over h2 {
  color: #ff0000;
  font-size: 3rem;
  margin-bottom: 20px;
}

.game-over p {
  font-size: 1.5rem;
  margin-bottom: 30px;
}

.game-over button {
  font-size: 1.5rem;
  padding: 15px 40px;
  background: linear-gradient(45deg, #ff0000, #ff8800);
}
</style>
</head>
<body>

<video autoplay loop muted id="bgVideo">
  <source src="2.mp4" type="video/mp4">
</video>
<div class="overlay"></div>

<div class="container">
  <div class="progress-bar">
    <div class="progress" id="progress"></div>
  </div>
  <div class="timer-display" id="timerDisplay">Tiempo: 20s</div>
  <h1 id="question">Pregunta</h1>
  <div class="options" id="options"></div>
  <div class="message" id="message"></div>
  <div class="bottom-row">
    <button id="sendBtn">Enviar</button>
  </div>
</div>

<div id="counter" style="position:absolute;top:20px;right:20px;display:flex;align-items:center;z-index:2;">
  <img src="23.png" alt="Counter" style="width:80px;height:80px;object-fit:contain;margin-right:10px;">
  <span id="totalCorrectDisplay" style="color:#fff;font-size:2rem;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.8);">0</span>
</div>

<div id="streakCounter" style="position:absolute;top:20px;left:20px;display:flex;align-items:center;z-index:2;">
  <span id="streakDisplay" style="color:#fff;font-size:2rem;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.8);margin-right:10px;">0</span>
  <img src="3.png" alt="Streak Counter" style="width:80px;height:80px;object-fit:contain;">
</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script>
const questions = [
  {q: "Â¿Por quÃ© es importante lavarse las manos?", a: [
    "Para eliminar gÃ©rmenes",
    "Porque huele bien",
    "Porque lo dice la mamÃ¡",
    "Para gastar jabÃ³n"
  ], correct: 0},
  
  {q: "Â¿CuÃ¡ndo debemos lavarnos las manos?", a: [
    "Antes de comer",
    "Solo por la maÃ±ana",
    "Cuando nos acordemos",
    "Una vez al dÃ­a"
  ], correct: 0},
  
  {q: "Â¿QuÃ© se usa para lavar las manos?", a: [
    "JabÃ³n y agua",
    "Solo agua",
    "Perfume",
    "Alcohol solo"
  ], correct: 0},
  
  {q: "Â¿CuÃ¡nto tiempo debe durar el lavado?", a: [
    "20 segundos",
    "5 segundos",
    "1 minuto",
    "10 segundos"
  ], correct: 0},
  
  {q: "Â¿QuÃ© protegen los guantes?", a: [
    "La piel de productos quÃ­micos",
    "Del frÃ­o solamente",
    "Para verse elegante",
    "De la lluvia"
  ], correct: 0},
  
  {q: "Â¿QuÃ© hacer si nos cortamos la mano?", a: [
    "Lavar y desinfectar",
    "Ignorarlo",
    "Poner alcohol directo",
    "Cubrir sin lavar"
  ], correct: 0},
  
  {q: "Â¿QuÃ© evitar al trabajar con herramientas?", a: [
    "Usar guantes rotos",
    "Lavarse despuÃ©s",
    "Usar protecciÃ³n",
    "Revisar las herramientas"
  ], correct: 0},
  
  {q: "Â¿Por quÃ© mantener las uÃ±as cortas?", a: [
    "Para evitar acumular suciedad",
    "Por moda",
    "Por comodidad",
    "Para pintarlas mejor"
  ], correct: 0},
  
  {q: "Â¿QuÃ© usar despuÃ©s de lavar mucho las manos?", a: [
    "Crema hidratante",
    "Alcohol puro",
    "Talco",
    "Perfume"
  ], correct: 0},
  
  {q: "Â¿QuÃ© hacer si cae producto quÃ­mico en la piel?", a: [
    "Lavar con agua abundante",
    "Secar rÃ¡pido",
    "Frotar con trapo",
    "Poner mÃ¡s producto"
  ], correct: 0},
  
  {q: "Â¿QuÃ© tipo de guantes usar para limpiar?", a: [
    "Guantes de goma",
    "Guantes de lana",
    "Guantes de cuero",
    "Guantes de tela"
  ], correct: 0},
  
  {q: "Â¿Por quÃ© revisar los guantes antes de usar?", a: [
    "Para ver si estÃ¡n rotos",
    "Para ver el color",
    "Para olerlos",
    "Para ajustarlos"
  ], correct: 0},
  
  {q: "Â¿QuÃ© es una infecciÃ³n en las manos?", a: [
    "Cuando entran gÃ©rmenes",
    "Cuando se ponen rojas",
    "Cuando sudan",
    "Cuando se ponen frÃ­as"
  ], correct: 0},
  
  {q: "Â¿CÃ³mo prevenir infecciones?", a: [
    "Lavado correcto de manos",
    "Usar perfume",
    "Usar anillos",
    "No tocar nada"
  ], correct: 0},
  
  {q: "Â¿QuÃ© no hacer con las manos sucias?", a: [
    "Tocar la cara",
    "Lavarlas",
    "Usar guantes",
    "Secarlas"
  ], correct: 0},
  
  {q: "Â¿CuÃ¡l es el paso final al lavar?", a: [
    "Secar con toalla limpia",
    "Dejar secar al aire",
    "Sacudir las manos",
    "Frotar en la ropa"
  ], correct: 0},
  
  {q: "Â¿QuÃ© hacer si no hay agua y jabÃ³n?", a: [
    "Usar gel desinfectante",
    "No lavarse",
    "Usar perfume",
    "Limpiar en la ropa"
  ], correct: 0},
  
  {q: "Â¿Por quÃ© usar crema para manos?", a: [
    "Para evitar que se resequen",
    "Para oler bien",
    "Por color",
    "Para brillar"
  ], correct: 0},
  
  {q: "Â¿QuÃ© indica una buena higiene?", a: [
    "Manos limpias y cuidadas",
    "Manos con anillos",
    "UÃ±as largas",
    "Manos perfumadas"
  ], correct: 0},
  
  {q: "Â¿QuÃ© hacer con heridas pequeÃ±as?", a: [
    "Lavar y cubrir",
    "Ignorar",
    "Poner alcohol directo",
    "Dejar al aire"
  ], correct: 0}
];

const streakPhrases = [
  "Â¡IncreÃ­ble! ðŸ”¥ Tres correctas seguidas",
  "Â¡Sigue asÃ­! ðŸ’ª Eres imparable",
  "Â¡Excelente racha! ðŸŽ‰",
  "Â¡Wow! ðŸŒŸ Tres en fila",
  "Â¡Genial! ðŸ† MantÃ©n la concentraciÃ³n"
];

let current = 0;
let streak = 0;
let totalCorrect = 0;
let streakCount = 0;
let selected = null;
let timer = null;
let timeLeft = 20;
let gameOver = false;
let incorrectCount = 0;
const MAX_INCORRECT = 3;

const questionEl = document.getElementById("question");
const optionsEl = document.getElementById("options");
const messageEl = document.getElementById("message");
const sendBtn = document.getElementById("sendBtn");
const progressEl = document.getElementById("progress");
const totalCorrectDisplay = document.getElementById("totalCorrectDisplay");
const streakDisplay = document.getElementById("streakDisplay");
const timerDisplay = document.getElementById("timerDisplay");

function showQuestion() {
  if (gameOver) return;
  
  if (current >= questions.length) {
    endGame();
    return;
  }
  
  // Limpiar temporizador anterior
  if (timer) {
    clearInterval(timer);
  }
  
  selected = null;
  timeLeft = 20;
  const q = questions[current];
  questionEl.textContent = (current + 1) + ". " + q.q;
  optionsEl.innerHTML = "";
  
  // Mostrar opciones
  q.a.forEach((opt, i) => {
    const btn = document.createElement("button");
    btn.textContent = String.fromCharCode(65 + i) + ". " + opt;
    btn.classList.add("option-btn");
    btn.addEventListener("click", () => {
      if (gameOver) return;
      selected = i;
      Array.from(optionsEl.children).forEach(b => {
        b.style.border = "";
        b.style.background = "black";
      });
      btn.style.border = "3px solid yellow";
      btn.style.background = "#007bff";
    });
    optionsEl.appendChild(btn);
  });
  
  messageEl.textContent = "";
  progressEl.style.width = "100%";
  
  // Iniciar nuevo temporizador
  timer = setInterval(() => {
    timeLeft -= 0.1;
    const progressPercent = (timeLeft / 20) * 100;
    progressEl.style.width = Math.max(0, progressPercent) + "%";
    timerDisplay.textContent = "Tiempo: " + Math.ceil(timeLeft) + "s";
    
    if (timeLeft <= 0) {
      clearInterval(timer);
      timeOut();
    }
  }, 100);
}

function timeOut() {
  if (gameOver) return;
  
  // Tiempo agotado cuenta como incorrecto
  incorrectCount++;
  new Audio('q.mp3').play();
  showFloatingImage('8.png', 'left');
  messageEl.textContent = "Â¡Tiempo agotado! ðŸ˜ž";
  messageEl.style.color = "#ff0000";
  
  // Verificar si se perdiÃ³ el juego
  if (incorrectCount >= MAX_INCORRECT) {
    gameOverScreen();
    return;
  }
  
  current++;
  setTimeout(() => {
    messageEl.textContent = "";
    messageEl.style.color = "";
    showQuestion();
  }, 2000);
}

function checkAnswer() {
  if (gameOver) return;
  
  if (selected === null) {
    messageEl.textContent = "Selecciona una opciÃ³n primero";
    messageEl.style.color = "#ffcc00";
    return;
  }
  
  clearInterval(timer);
  const q = questions[current];
  
  if (selected === q.correct) {
    // Respuesta correcta
    new Audio('o.mp3').play();
    streak++;
    totalCorrect++;
    incorrectCount = 0; // Reiniciar contador de incorrectas
    
    if (streak > 0 && streak % 3 === 0) {
      handleStreakBonus();
      return;
    }
    
    showFloatingImage('9.png', 'right');
    confetti({particleCount:500,spread:360,colors:['#00ff00','#00bfa5'],gravity:0.1,scalar:1.2});
    messageEl.textContent = "Â¡Correcto! âœ…";
    messageEl.style.color = "#00ff00";
  } else {
    // Respuesta incorrecta
    new Audio('q.mp3').play();
    showFloatingImage('8.png', 'left');
    streak = 0;
    incorrectCount++;
    messageEl.textContent = "Incorrecto âŒ";
    messageEl.style.color = "#ff0000";
    
    // Verificar si se perdiÃ³ el juego
    if (incorrectCount >= MAX_INCORRECT) {
      setTimeout(gameOverScreen, 1500);
      return;
    }
  }
  
  current++;
  totalCorrectDisplay.textContent = totalCorrect;
  streakDisplay.textContent = streakCount;
  
  setTimeout(() => {
    messageEl.textContent = "";
    messageEl.style.color = "";
    showQuestion();
  }, 1500);
}

function handleStreakBonus() {
  // Ocultar elementos temporales
  timerDisplay.style.display = 'none';
  questionEl.style.display = 'none';
  optionsEl.style.display = 'none';
  sendBtn.style.display = 'none';
  progressEl.parentElement.style.display = 'none';
  
  // Mostrar mensaje de racha
  const phrase = streakPhrases[Math.floor(Math.random() * streakPhrases.length)];
  messageEl.textContent = phrase;
  messageEl.style.position = 'fixed';
  messageEl.style.top = '50%';
  messageEl.style.left = '50%';
  messageEl.style.transform = 'translate(-50%, -50%)';
  messageEl.style.fontSize = '4rem';
  messageEl.style.textAlign = 'center';
  messageEl.style.zIndex = '20';
  messageEl.style.animation = 'fadeIn 0.5s ease-in';
  messageEl.style.color = "#00ff00";
  
  showFloatingImage('3.png', 'left');
  streakCount++;
  confetti({particleCount:800,spread:360,colors:['#00ff00','#00bfa5'],gravity:0.1,scalar:1.2});
  
  // Continuar despuÃ©s de 3 segundos
  setTimeout(() => {
    messageEl.textContent = "";
    messageEl.style.position = '';
    messageEl.style.top = '';
    messageEl.style.left = '';
    messageEl.style.transform = '';
    messageEl.style.fontSize = '';
    messageEl.style.textAlign = '';
    messageEl.style.zIndex = '';
    messageEl.style.animation = '';
    messageEl.style.color = "";
    
    // Mostrar elementos nuevamente
    timerDisplay.style.display = '';
    questionEl.style.display = '';
    optionsEl.style.display = '';
    sendBtn.style.display = '';
    progressEl.parentElement.style.display = '';
    
    current++;
    totalCorrectDisplay.textContent = totalCorrect;
    streakDisplay.textContent = streakCount;
    showQuestion();
  }, 3000);
}

function gameOverScreen() {
  gameOver = true;
  clearInterval(timer);
  
  const gameOverDiv = document.createElement('div');
  gameOverDiv.className = 'game-over';
  gameOverDiv.innerHTML = `
    <h2>Â¡GAME OVER!</h2>
    <p>Has cometido ${MAX_INCORRECT} errores</p>
    <p>Respuestas correctas: ${totalCorrect}</p>
    <p>Rachas conseguidas: ${streakCount}</p>
    <button onclick="restartGame()">Reiniciar Juego</button>
  `;
  
  document.body.appendChild(gameOverDiv);
  new Audio('q.mp3').play();
}

function restartGame() {
  gameOver = false;
  current = 0;
  streak = 0;
  totalCorrect = 0;
  streakCount = 0;
  incorrectCount = 0;
  
  const gameOverDiv = document.querySelector('.game-over');
  if (gameOverDiv) {
    document.body.removeChild(gameOverDiv);
  }
  
  totalCorrectDisplay.textContent = totalCorrect;
  streakDisplay.textContent = streakCount;
  shuffle(questions);
  showQuestion();
}

function endGame() {
  // Todas las preguntas contestadas - Victoria
  gameOver = true;
  clearInterval(timer);
  
  const gameOverDiv = document.createElement('div');
  gameOverDiv.className = 'game-over';
  gameOverDiv.style.borderColor = '#00ff00';
  gameOverDiv.style.boxShadow = '0 0 30px rgba(0, 255, 0, 0.5)';
  gameOverDiv.innerHTML = `
    <h2 style="color: #00ff00">Â¡FELICIDADES!</h2>
    <p>Has completado todas las preguntas</p>
    <p>Respuestas correctas: ${totalCorrect}/${questions.length}</p>
    <p>Rachas conseguidas: ${streakCount}</p>
    <button onclick="restartGame()">Jugar de Nuevo</button>
  `;
  
  document.body.appendChild(gameOverDiv);
  new Audio('o.mp3').play();
  confetti({particleCount:1000,spread:360,colors:['#00ff00','#00bfa5','#ff0000','#ffcc00'],gravity:0.1,scalar:1.5});
}

function showFloatingImage(src, side) {
  const img = document.createElement('img');
  img.src = src;
  img.style.position = 'absolute';
  img.style.width = '150px';
  img.style.height = '150px';
  img.style.objectFit = 'contain';
  img.style.zIndex = '10';
  img.style.pointerEvents = 'none';
  img.style.animation = 'floatUp 1s ease-out forwards';
  img.style.top = '50%';
  img.style.transform = 'translateY(-50%)';

  if (side === 'right') {
    img.style.right = '20px';
  } else {
    img.style.left = '20px';
  }

  document.body.appendChild(img);
  setTimeout(() => {
    document.body.removeChild(img);
  }, 1000);
}

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

// Event listeners
sendBtn.addEventListener("click", checkAnswer);

// Inicializar juego
shuffle(questions);
showQuestion();

// Configurar video
const bgVideo = document.getElementById("bgVideo");
bgVideo.addEventListener('ended', function() {
  bgVideo.play();
});

// Habilitar sonido
function enableSound() {
  bgVideo.muted = false;
  bgVideo.volume = 0.5;
  document.removeEventListener("click", enableSound);
  document.removeEventListener("keydown", enableSound);
}
document.addEventListener("click", enableSound);
document.addEventListener("keydown", enableSound);
</script>

>>>>>>> b246c7419bb2345f7f299a8dba9cfc226c2ebcbb
</body>
</html>